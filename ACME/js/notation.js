(()=>{"use strict";let e=["a1","a2","a3","a4","a5","a6","a7","a8","b1","b2","b3","b4","b5","b6","b7","b8","c1","c2","c3","c4","c5","c6","c7","c8","d1","d2","d3","d4","d5","d6","d7","d8","e1","e2","e3","e4","e5","e6","e7","e8","f1","f2","f3","f4","f5","f6","f7","f8","g1","g2","g3","g4","g5","g6","g7","g8","h1","h2","h3","h4","h5","h6","h7","h8"],t=null;const o=function o(){let s=Math.floor(Math.random()*e.length);return s===t?o():(t=s,document.querySelector(".board-chess__nowSquare").textContent=e[s],e[s])};let s;const c=document.querySelector(".moveHistory-chess__box"),n=document.querySelector(".moveHistory-chess__wrapper"),r=document.querySelector(".moveHistory-chess__goTop"),l=document.querySelector(".moveHistory-chess__goBottom"),i=document.querySelector(".mobBottom-chess__moves"),u=document.querySelector(".mobBottom-chess__startArrow"),a=document.querySelector(".mobBottom-chess__leftArrow"),d=document.querySelector(".mobBottom-chess__rightArrow"),f=document.querySelector(".mobBottom-chess__endArrow");function m(){c.scrollTop=n.offsetHeight-c.offsetHeight}function h(){let e=Math.ceil(c.scrollTop),t=c.offsetHeight,o=n.offsetHeight;0===e&&o>t?(p(),y()):e>0&&o-(e+t)>37?(p(),g()):e>0&&o-(e+t)<37?(q(),g()):(q(),y())}function v(){Math.ceil(c.scrollTop)/c.offsetHeight>=1?c.scrollTop=c.scrollTop-c.offsetHeight:c.scrollTop=0,h()}function L(){let e=Math.ceil(c.scrollTop),t=c.offsetHeight,o=n.offsetHeight;o-(Math.ceil(e)+t)/t>1?c.scrollTop+=c.offsetHeight:c.scrollTop+=o-(Math.ceil(e)+t),h()}function g(){r.classList.remove("hide")}function y(){r.classList.add("hide")}function p(){l.classList.remove("hide")}function q(){l.classList.add("hide")}function _(){console.log(i.scrollLeft,i.scrollWidth,i.offsetWidth),0===i.scrollLeft&&i.scrollWidth<=i.offsetWidth?(u.classList.add("off"),a.classList.add("off"),d.classList.add("off"),f.classList.add("off")):i.scrollLeft>0&&Math.ceil(i.scrollLeft)+i.offsetWidth>=i.scrollWidth?(u.classList.remove("off"),a.classList.remove("off"),d.classList.add("off"),f.classList.add("off")):0===i.scrollLeft?(u.classList.add("off"),a.classList.add("off"),d.classList.remove("off"),f.classList.remove("off")):(u.classList.remove("off"),a.classList.remove("off"),d.classList.remove("off"),f.classList.remove("off"))}function S(){const e=i.scrollLeft%100;i.scrollLeft-=e||100,_()}function b(){i.scrollLeft=0,_()}function M(){const e=i.scrollLeft%100;i.scrollLeft+=100-e,_()}function w(){i.scrollLeft=i.scrollWidth,_()}function E(){document.querySelector(".resultPopup-chess").classList.add("hide")}let A=!1;function k(){A=!0,document.querySelector(".settingsPopup-chess").classList.add("hide")}function H(){A=!1,document.querySelector(".settingsPopup-chess").classList.remove("hide")}let P=["Легкий","Нормальный","Сложный"],C={nick:"Anonymous",level:null,rightMove:0,wrongMove:0,result:0,set setLevel(e){this.level=e},set setRightMove(e){this.rightMove=e},set setWrongMove(e){this.wrongMove=e},set setResult(e){this.result=e}},T=null,x=null,R=[];function W(e){var t;x=!0,B(),O(),n.innerHTML="",i.innerHTML="",h(),R=[],T=o(),C.setLevel=e,$(),_(),document.querySelector(".miniHeader__results").onclick=()=>{!1!==x&&document.querySelector(".bestResultPopup").classList.remove("hide")},document.querySelector(".miniHeader__results").classList.remove("off"),1===C.level?I():V(),3===C.level?z():D(),t=15,clearInterval(s),function(e){let t=performance.now();function o(){let o=performance.now()-t,c=Math.max(0,1e3*e-o),n=Math.floor(c/6e4),r=Math.ceil(c%6e4/1e3);60===r&&(n++,r=0),function(e){Array.from(document.querySelectorAll(".time-chess__num")).forEach(((t,o)=>{t.textContent=e[o]}));let t=[e.slice(0,2),e.slice(2)];Array.from(document.querySelectorAll("#mobTime span")).forEach(((e,o)=>{e.textContent=t[o]}))}(("0"+n).slice(-2)+("0"+r).slice(-2)),c<=0&&(clearInterval(s),x=!1,V(),Q(),function(){let e=document.querySelector("#resultNick"),t=document.querySelector("#resultLevel"),o=document.querySelector("#resultRightMove"),s=document.querySelector("#resultWrongMove"),c=document.querySelector("#allResult");e.textContent=C.nick,t.textContent=P[C.level-1],o.textContent=C.rightMove,s.textContent=C.wrongMove,c.textContent=C.result}(),document.querySelector(".resultPopup-chess").classList.remove("hide"),document.querySelector(".miniHeader__results").classList.add("off"))}o(),s=setInterval(o,100)}(t)}function B(){C.setLevel=null,C.setRightMove=0,C.setWrongMove=0,C.setResult=0}function $(){Array.from(document.querySelectorAll(".square-55d63")).forEach((e=>{e.onclick=()=>function(e){if(!x)return;let t=null,s="";e.dataset.square===T?(C.setRightMove=C.rightMove+1,t=!0):(C.setWrongMove=C.wrongMove+1,t=!1,s=T),C.setResult=C.rightMove,R.push({square:e.dataset.square,isRightMove:t,rightMove:s}),function(e){n.innerHTML+=function(e){let t=e[e.length-1].isRightMove;return`<div class="moveHistory-chess__move ${t?"":"wrong"}">\n                        <span>${e.length}.</span><span>${e[e.length-1].square}${t?"":`(<span>${e[e.length-1].rightMove}</span>)`} </span>\n                    </div>`}(e),m(),h(),r.onclick=v,l.onclick=L,i.innerHTML+=function(e){let t=e[e.length-1].isRightMove;return`<span class="${t?"":"wrong"}">\n                        ${e[e.length-1].square}${t?"":`(<span>${e[e.length-1].rightMove}</span>)`}\n                    </span>`}(e),i.scrollLeft=i.scrollWidth,_(),u.onclick=b,a.onclick=S,d.onclick=M,f.onclick=w}(R),T=o(),1===C.level&&I(),O()}(e)}))}function I(){V(),document.querySelector(`.square-${T}`).classList.add("star")}function V(){Array.from(document.querySelectorAll(".square-55d63")).forEach((e=>e.classList.remove("star")))}function z(){Array.from(document.querySelectorAll(".notation-322f9")).forEach((e=>e.classList.add("hide")))}function D(){Array.from(document.querySelectorAll(".notation-322f9")).forEach((e=>e.classList.remove("hide")))}function O(){let e=document.querySelector("#score"),t=document.querySelector("#mobScore");e.textContent=C.result,t.textContent=C.result}function N(e){let t=document.querySelector(".board-chess__wrapper"),o=(document.querySelector(".board-b72b1"),document.querySelector(".board-chess__board"));function s(){let s=t.offsetWidth,c=t.offsetHeight,n=30;window.innerWidth<=479.98&&(n=20),s>c?(o.style.width=c-n+"px",e.resize(c-n,c-n)):(o.style.width=s-n+"px",e.resize(s-n,s-n)),$(),1===C.level?I():V(),3===C.level?z():D(),m(),h()}s(),window.addEventListener("resize",s)}document.querySelector("#startGameMenu").onclick=()=>{Q(),E(),B(),V(),H(),x=!1};let G,j,F;function J(){k(),E();let e={orientation:j.value};G=Chessboard("board",e),N(G),K(),W(F.value),document.querySelector(".resultPopup-chess__close").onclick=()=>{K(),E(),function(){let e=document.querySelector(".board-chess__nowSquare");e.classList.add("btn"),e.textContent="Попробовать снова",e.addEventListener("click",(()=>{J(),e.classList.remove("btn")}),{once:!0})}()}}function K(){[document.querySelector(".board-chess__nowSquare"),document.querySelector(".chess__left"),document.querySelector(".chess__right"),document.querySelector(".mobBottom-chess"),document.querySelector(".mobTop-chess")].forEach((e=>{e.classList.remove("hide")}))}function Q(){[document.querySelector(".board-chess__nowSquare"),document.querySelector(".chess__left"),document.querySelector(".chess__right"),document.querySelector(".mobBottom-chess"),document.querySelector(".mobTop-chess")].forEach((e=>{console.log(e),e.classList.add("hide")}))}F={value:1,set setValue(e){this.value=e,console.log(this.value)}},j={value:"white",set setValue(e){this.value=e,console.log(this.value)}},document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".burger-header"),t=document.querySelector("body"),o=document.querySelector("header"),s=document.querySelector(".header__backdrop");function c(){e.classList.remove("active"),t.classList.remove("hide"),o.classList.remove("on")}e.addEventListener("click",(function(s){s.target.classList.contains("menu-burger__list")||s.target.classList.contains("search-header__input")||(s.target.parentNode.classList.contains("menu-burger__item")?c():(e.classList.toggle("active"),t.classList.toggle("hide"),o.classList.toggle("on")))})),s.addEventListener("click",(()=>{c()}))}),!1),document.addEventListener("DOMContentLoaded",(function(){let e=Array.from(document.querySelectorAll(".a")),t=e.length;window.addEventListener("load",(()=>{function o(e){e.classList.contains("part")?function(e){(function(e){let t=e.getBoundingClientRect(),o=t.top,s=t.bottom,c=t.height;return o+c>=0&&c+window.innerHeight>=s})(e)&&(e.classList.add("v"),e.classList.remove("part"),e.classList.remove("a"),t--)}(e):e.classList.contains("full")&&function(e){(function(e){let t=e.getBoundingClientRect(),o=t.top,s=t.bottom;return o>=0&&s<=window.innerHeight})(e)&&(e.classList.add("v"),e.classList.remove("full"),e.classList.remove("a"),t--)}(e)}e.map((e=>o(e))),window.addEventListener("scroll",(()=>{t>0&&e.forEach((e=>{o(e)}))}))}))}),!1),document.addEventListener("DOMContentLoaded",(()=>{Q(),H(),Array.from(document.querySelectorAll(".difficulty-settingsPopup__level")).forEach((e=>{e.addEventListener("click",(()=>{A||(Array.from(document.querySelectorAll(".difficulty-settingsPopup__level")).forEach((e=>{e.classList.remove("select")})),F.setValue=+e.dataset.level,e.classList.add("select"))}))})),Array.from(document.querySelectorAll(".settingsPopup-side__color")).forEach((e=>{e.addEventListener("click",(()=>{A||(Array.from(document.querySelectorAll(".settingsPopup-side__color")).forEach((e=>{e.classList.remove("select")})),j.setValue=e.dataset.orientation,e.classList.add("select"))}))})),document.querySelector(".settingsPopup-chess__close").onclick=k,function(){let e=document.querySelector(".signInPopup__close"),t=document.querySelector(".signInPopup");e.addEventListener("click",(()=>t.classList.add("hide")))}(),function(){let e=document.querySelector("#passwordSignIn"),t=document.querySelector(".signInPopup__passwordToggle");t.addEventListener("click",(()=>{t.classList.toggle("hidePas"),t.classList.contains("hidePas")?e.type="password":e.type="text"}))}(),function(){let e=document.querySelector(".miniHeader__signIn"),t=document.querySelector(".signInPopup");e.addEventListener("click",(()=>t.classList.remove("hide")))}(),function(){let e=document.querySelector(".bestResultPopup__close"),t=document.querySelector(".bestResultPopup");e.addEventListener("click",(()=>t.classList.add("hide")))}();let e={orientation:j.value};G=Chessboard("board",e),N(G);let t=document.querySelector("#play"),o=document.querySelector("#playAgain");t.addEventListener("click",J),o.addEventListener("click",J)}))})();