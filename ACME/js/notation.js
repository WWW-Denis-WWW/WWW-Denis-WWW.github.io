(()=>{"use strict";let e=["a1","a2","a3","a4","a5","a6","a7","a8","b1","b2","b3","b4","b5","b6","b7","b8","c1","c2","c3","c4","c5","c6","c7","c8","d1","d2","d3","d4","d5","d6","d7","d8","e1","e2","e3","e4","e5","e6","e7","e8","f1","f2","f3","f4","f5","f6","f7","f8","g1","g2","g3","g4","g5","g6","g7","g8","h1","h2","h3","h4","h5","h6","h7","h8"],t=null;const o=function o(){let s=Math.floor(Math.random()*e.length);return s===t?o():(t=s,document.querySelector(".board-chess__nowSquare").textContent=e[s],e[s])};let s;const c=document.querySelector(".moveHistory-chess__box"),r=document.querySelector(".moveHistory-chess__wrapper"),l=document.querySelector(".moveHistory-chess__goTop"),n=document.querySelector(".moveHistory-chess__goBottom"),i=document.querySelector(".mobBottom-chess__moves"),u=document.querySelector(".mobBottom-chess__startArrow"),a=document.querySelector(".mobBottom-chess__leftArrow"),d=document.querySelector(".mobBottom-chess__rightArrow"),f=document.querySelector(".mobBottom-chess__endArrow");function m(){c.scrollTop=r.offsetHeight-c.offsetHeight}function h(){let e=Math.ceil(c.scrollTop),t=c.offsetHeight,o=r.offsetHeight;0===e&&o>t?(q(),y()):e>0&&o-(e+t)>37?(q(),g()):e>0&&o-(e+t)<37?(p(),g()):(p(),y())}function v(){Math.ceil(c.scrollTop)/c.offsetHeight>=1?c.scrollTop=c.scrollTop-c.offsetHeight:c.scrollTop=0,h()}function L(){let e=Math.ceil(c.scrollTop),t=c.offsetHeight,o=r.offsetHeight;o-(Math.ceil(e)+t)/t>1?c.scrollTop+=c.offsetHeight:c.scrollTop+=o-(Math.ceil(e)+t),h()}function g(){l.classList.remove("hide")}function y(){l.classList.add("hide")}function q(){n.classList.remove("hide")}function p(){n.classList.add("hide")}function _(){console.log(i.scrollLeft,i.scrollWidth,i.offsetWidth),0===i.scrollLeft&&i.scrollWidth<=i.offsetWidth?(u.classList.add("off"),a.classList.add("off"),d.classList.add("off"),f.classList.add("off")):i.scrollLeft>0&&Math.ceil(i.scrollLeft)+i.offsetWidth>=i.scrollWidth?(u.classList.remove("off"),a.classList.remove("off"),d.classList.add("off"),f.classList.add("off")):0===i.scrollLeft?(u.classList.add("off"),a.classList.add("off"),d.classList.remove("off"),f.classList.remove("off")):(u.classList.remove("off"),a.classList.remove("off"),d.classList.remove("off"),f.classList.remove("off"))}function S(){const e=i.scrollLeft%100;i.scrollLeft-=e||100,_()}function b(){i.scrollLeft=0,_()}function M(){const e=i.scrollLeft%100;i.scrollLeft+=100-e,_()}function w(){i.scrollLeft=i.scrollWidth,_()}let E=["Легкий","Нормальный","Сложный"],A={nick:"Anonymous",level:null,rightMove:0,wrongMove:0,result:0,set setLevel(e){this.level=e},set setRightMove(e){this.rightMove=e},set setWrongMove(e){this.wrongMove=e},set setResult(e){this.result=e}},H=null,k=!1,T=[];function C(e){var t;k=!0,A.setLevel=null,A.setRightMove=0,A.setWrongMove=0,A.setResult=0,I(),r.innerHTML="",i.innerHTML="",h(),T=[],H=o(),A.setLevel=e,P(),_(),document.querySelector(".miniHeader__results").onclick=()=>{!1!==k&&document.querySelector(".bestResultPopup").classList.remove("hide")},document.querySelector(".miniHeader__results").classList.remove("off"),1===A.level?x():W(),3===A.level?R():B(),t=15,clearInterval(s),function(e){let t=performance.now();function o(){let o=performance.now()-t,c=Math.max(0,1e3*e-o),r=Math.floor(c/6e4),l=Math.ceil(c%6e4/1e3);60===l&&(r++,l=0),function(e){Array.from(document.querySelectorAll(".time-chess__num")).forEach(((t,o)=>{t.textContent=e[o]}));let t=[e.slice(0,2),e.slice(2)];Array.from(document.querySelectorAll("#mobTime span")).forEach(((e,o)=>{e.textContent=t[o]}))}(("0"+r).slice(-2)+("0"+l).slice(-2)),c<=0&&(clearInterval(s),k=!1,W(),j(),function(){let e=document.querySelector("#resultNick"),t=document.querySelector("#resultLevel"),o=document.querySelector("#resultRightMove"),s=document.querySelector("#resultWrongMove"),c=document.querySelector("#allResult");e.textContent=A.nick,t.textContent=E[A.level-1],o.textContent=A.rightMove,s.textContent=A.wrongMove,c.textContent=A.result}(),document.querySelector(".resultPopup-chess").classList.remove("hide"),document.querySelector(".miniHeader__results").classList.add("off"))}o(),s=setInterval(o,100)}(t)}function P(){Array.from(document.querySelectorAll(".square-55d63")).forEach((e=>{e.onclick=()=>function(e){if(!k)return;let t=null;e.dataset.square===H?(A.setRightMove=A.rightMove+1,t=!0):(A.setWrongMove=A.wrongMove+1,t=!1),A.setResult=A.rightMove,T.push({square:e.dataset.square,rightMove:t}),function(e){r.innerHTML+=function(e){return`<div class="moveHistory-chess__move ${e[e.length-1].rightMove?"":"wrong"}">\n                        <span>${e.length}.</span><span>${e[e.length-1].square}</span>\n                    </div>`}(e),m(),h(),l.onclick=v,n.onclick=L,i.innerHTML+=function(e){return`<span class="${e[e.length-1].rightMove?"":"wrong"}">${e[e.length-1].square}</span>`}(e),i.scrollLeft=i.scrollWidth,_(),u.onclick=b,a.onclick=S,d.onclick=M,f.onclick=w}(T),H=o(),1===A.level&&x(),I()}(e)}))}function x(){W(),document.querySelector(`.square-${H}`).classList.add("star")}function W(){Array.from(document.querySelectorAll(".square-55d63")).forEach((e=>e.classList.remove("star")))}function R(){Array.from(document.querySelectorAll(".notation-322f9")).forEach((e=>e.classList.add("hide")))}function B(){Array.from(document.querySelectorAll(".notation-322f9")).forEach((e=>e.classList.remove("hide")))}function I(){let e=document.querySelector("#score"),t=document.querySelector("#mobScore");e.textContent=A.result,t.textContent=A.result}function $(e){let t=document.querySelector(".board-chess__wrapper"),o=(document.querySelector(".board-b72b1"),document.querySelector(".board-chess__board"));function s(){let s=t.offsetWidth,c=t.offsetHeight,r=30;window.innerWidth<=479.98&&(r=20),s>c?(o.style.width=c-r+"px",e.resize(c-r,c-r)):(o.style.width=s-r+"px",e.resize(s-r,s-r)),P(),1===A.level?x():W(),3===A.level?R():B(),m(),h()}s(),window.addEventListener("resize",s)}let V=!1;let z,D,O;function N(){V=!0,document.querySelector(".settingsPopup-chess").classList.add("hide"),document.querySelector(".resultPopup-chess").classList.add("hide");let e={orientation:D.value};z=Chessboard("board",e),$(z),[document.querySelector(".board-chess__nowSquare"),document.querySelector(".chess__left"),document.querySelector(".chess__right"),document.querySelector(".mobBottom-chess"),document.querySelector(".mobTop-chess")].forEach((e=>{e.classList.remove("hide")})),C(O.value)}function j(){[document.querySelector(".board-chess__nowSquare"),document.querySelector(".chess__left"),document.querySelector(".chess__right"),document.querySelector(".mobBottom-chess"),document.querySelector(".mobTop-chess")].forEach((e=>{console.log(e),e.classList.add("hide")}))}O={value:1,set setValue(e){this.value=e,console.log(this.value)}},D={value:"white",set setValue(e){this.value=e,console.log(this.value)}},document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".burger-header"),t=document.querySelector("body"),o=document.querySelector("header"),s=document.querySelector(".header__backdrop");function c(){e.classList.remove("active"),t.classList.remove("hide"),o.classList.remove("on")}e.addEventListener("click",(function(s){s.target.classList.contains("menu-burger__list")||s.target.classList.contains("search-header__input")||(s.target.parentNode.classList.contains("menu-burger__item")?c():(e.classList.toggle("active"),t.classList.toggle("hide"),o.classList.toggle("on")))})),s.addEventListener("click",(()=>{c()}))}),!1),document.addEventListener("DOMContentLoaded",(function(){let e=Array.from(document.querySelectorAll(".a")),t=e.length;window.addEventListener("load",(()=>{function o(e){e.classList.contains("part")?function(e){(function(e){let t=e.getBoundingClientRect(),o=t.top,s=t.bottom,c=t.height;return o+c>=0&&c+window.innerHeight>=s})(e)&&(e.classList.add("v"),e.classList.remove("part"),e.classList.remove("a"),t--)}(e):e.classList.contains("full")&&function(e){(function(e){let t=e.getBoundingClientRect(),o=t.top,s=t.bottom;return o>=0&&s<=window.innerHeight})(e)&&(e.classList.add("v"),e.classList.remove("full"),e.classList.remove("a"),t--)}(e)}e.map((e=>o(e))),window.addEventListener("scroll",(()=>{t>0&&e.forEach((e=>{o(e)}))}))}))}),!1),document.addEventListener("DOMContentLoaded",(()=>{j(),V=!1,document.querySelector(".settingsPopup-chess").classList.remove("hide"),Array.from(document.querySelectorAll(".difficulty-settingsPopup__level")).forEach((e=>{e.addEventListener("click",(()=>{V||(Array.from(document.querySelectorAll(".difficulty-settingsPopup__level")).forEach((e=>{e.classList.remove("select")})),O.setValue=+e.dataset.level,e.classList.add("select"))}))})),Array.from(document.querySelectorAll(".settingsPopup-side__color")).forEach((e=>{e.addEventListener("click",(()=>{V||(Array.from(document.querySelectorAll(".settingsPopup-side__color")).forEach((e=>{e.classList.remove("select")})),D.setValue=e.dataset.orientation,e.classList.add("select"))}))})),function(){let e=document.querySelector(".signInPopup__close"),t=document.querySelector(".signInPopup");e.addEventListener("click",(()=>t.classList.add("hide")))}(),function(){let e=document.querySelector("#passwordSignIn"),t=document.querySelector(".signInPopup__passwordToggle");t.addEventListener("click",(()=>{t.classList.toggle("hidePas"),t.classList.contains("hidePas")?e.type="password":e.type="text"}))}(),function(){let e=document.querySelector(".miniHeader__signIn"),t=document.querySelector(".signInPopup");e.addEventListener("click",(()=>t.classList.remove("hide")))}(),function(){let e=document.querySelector(".bestResultPopup__close"),t=document.querySelector(".bestResultPopup");e.addEventListener("click",(()=>t.classList.add("hide")))}();let e={orientation:D.value};z=Chessboard("board",e),$(z);let t=document.querySelector("#play"),o=document.querySelector("#playAgain");t.addEventListener("click",N,{once:!0}),o.addEventListener("click",N)}))})();