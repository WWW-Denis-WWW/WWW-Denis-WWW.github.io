(()=>{"use strict";let e=["a1","a2","a3","a4","a5","a6","a7","a8","b1","b2","b3","b4","b5","b6","b7","b8","c1","c2","c3","c4","c5","c6","c7","c8","d1","d2","d3","d4","d5","d6","d7","d8","e1","e2","e3","e4","e5","e6","e7","e8","f1","f2","f3","f4","f5","f6","f7","f8","g1","g2","g3","g4","g5","g6","g7","g8","h1","h2","h3","h4","h5","h6","h7","h8"],t=null;const o=function o(){let s=Math.floor(Math.random()*e.length);return s===t?o():(t=s,document.querySelector(".board-chess__nowSquare").textContent=e[s],e[s])};let s,r=document.querySelector(".moveHistory-chess__box"),n=document.querySelector(".moveHistory-chess__wrapper"),c=document.querySelector(".moveHistory-chess__goTop"),l=document.querySelector(".moveHistory-chess__goBottom");function i(){let e=Math.ceil(r.scrollTop),t=r.offsetHeight,o=n.offsetHeight;console.log(e,t,o),0===e&&o>t?(f(),h()):e>0&&o-(e+t)>37?(f(),d()):e>0&&o-(e+t)<37?(m(),d()):(m(),h())}function a(){Math.ceil(r.scrollTop)/r.offsetHeight>=1?r.scrollTop=r.scrollTop-r.offsetHeight:r.scrollTop=0,i()}function u(){let e=Math.ceil(r.scrollTop),t=r.offsetHeight,o=n.offsetHeight;o-(Math.ceil(e)+t)/t>1?r.scrollTop+=r.offsetHeight:r.scrollTop+=o-(Math.ceil(e)+t),i()}function d(){c.classList.remove("hide")}function h(){c.classList.add("hide")}function f(){l.classList.remove("hide")}function m(){l.classList.add("hide")}let v=["Легкий","Нормальный","Сложный"],g={nick:"Anonymous",level:null,rightMove:0,wrongMove:0,result:0,set setLevel(e){this.level=e},set setRightMove(e){this.rightMove=e},set setWrongMove(e){this.wrongMove=e},set setResult(e){this.result=e}},y=null,L=!1,q=[];function p(e){var t;L=!0,g.setLevel=null,g.setRightMove=0,g.setWrongMove=0,g.setResult=0,E(),n.innerHTML="",i(),g.setLevel=e,y=o(),_(),1===g.level?S():M(),3===g.level?b():w(),t=30,clearInterval(s),function(e){let t=performance.now();function o(){let o=performance.now()-t,r=Math.max(0,1e3*e-o),n=Math.floor(r/6e4),c=Math.ceil(r%6e4/1e3),l=("0"+n).slice(-2)+("0"+c).slice(-2);var i;i=l,Array.from(document.querySelectorAll(".time-chess__num")).forEach(((e,t)=>{e.textContent=i[t]})),r<=0&&(clearInterval(s),L=!1,M(),[document.querySelector(".board-chess__nowSquare"),document.querySelector(".chess__left"),document.querySelector(".chess__right")].forEach((e=>{e.classList.add("hide")})),function(){let e=document.querySelector("#resultNick"),t=document.querySelector("#resultLevel"),o=document.querySelector("#resultRightMove"),s=document.querySelector("#resultWrongMove"),r=document.querySelector("#allResult");e.textContent=g.nick,t.textContent=v[g.level-1],o.textContent=g.rightMove,s.textContent=g.wrongMove,r.textContent=g.result}(),document.querySelector(".resultPopup-chess").classList.remove("hide"))}o(),s=setInterval(o,100)}(t)}function _(){Array.from(document.querySelectorAll(".square-55d63")).forEach((e=>{e.onclick=()=>function(e){if(!L)return;let t=null;e.dataset.square===y?(g.setRightMove=g.rightMove+1,t=!0):(g.setWrongMove=g.wrongMove+1,t=!1),g.setResult=g.rightMove+g.wrongMove,q.push({square:e.dataset.square,rightMove:t}),function(e){n.innerHTML+=function(e){return`<div class="moveHistory-chess__move ${e[e.length-1].rightMove?"":"wrong"}">\n                        <span>${e.length}.</span><span>${e[e.length-1].square}</span>\n                    </div>`}(e),r.scrollTop=n.offsetHeight-r.offsetHeight,i(),c.onclick=a,l.onclick=u}(q),y=o(),1===g.level&&S(),E()}(e)}))}function S(){M(),document.querySelector(`.square-${y}`).classList.add("star")}function M(){Array.from(document.querySelectorAll(".square-55d63")).forEach((e=>e.classList.remove("star")))}function b(){Array.from(document.querySelectorAll(".notation-322f9")).forEach((e=>e.classList.add("hide")))}function w(){Array.from(document.querySelectorAll(".notation-322f9")).forEach((e=>e.classList.remove("hide")))}function E(){document.querySelector("#score").textContent=g.result}function A(e){let t=document.querySelector(".board-chess__wrapper"),o=(document.querySelector(".board-b72b1"),document.querySelector(".board-chess__board"));function s(){let s=t.offsetWidth,r=t.offsetHeight,n=30;window.innerWidth<=479.98&&(n=20),s>r?(o.style.width=r-n+"px",e.resize(r-n,r-n)):(o.style.width=s-n+"px",e.resize(s-n,s-n)),_(),1===g.level?S():M(),3===g.level?b():w()}s(),window.addEventListener("resize",s)}let H,C,k,x=!1;function T(){x=!0,document.querySelector(".settingsPopup-chess").classList.add("hide"),document.querySelector(".resultPopup-chess").classList.add("hide");let e={orientation:C.value};H=Chessboard("board",e),A(H),[document.querySelector(".board-chess__nowSquare"),document.querySelector(".chess__left"),document.querySelector(".chess__right")].forEach((e=>{e.classList.remove("hide")})),p(k.value)}k={value:1,set setValue(e){this.value=e,console.log(this.value)}},C={value:"white",set setValue(e){this.value=e,console.log(this.value)}},document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".burger-header"),t=document.querySelector("body"),o=document.querySelector("header"),s=document.querySelector(".header__backdrop");function r(){e.classList.remove("active"),t.classList.remove("hide"),o.classList.remove("on")}e.addEventListener("click",(function(s){s.target.classList.contains("menu-burger__list")||s.target.classList.contains("search-header__input")||(s.target.parentNode.classList.contains("menu-burger__item")?r():(e.classList.toggle("active"),t.classList.toggle("hide"),o.classList.toggle("on")))})),s.addEventListener("click",(()=>{r()}))}),!1),document.addEventListener("DOMContentLoaded",(function(){let e=Array.from(document.querySelectorAll(".a")),t=e.length;window.addEventListener("load",(()=>{function o(e){e.classList.contains("part")?function(e){(function(e){let t=e.getBoundingClientRect(),o=t.top,s=t.bottom,r=t.height;return o+r>=0&&r+window.innerHeight>=s})(e)&&(e.classList.add("v"),e.classList.remove("part"),e.classList.remove("a"),t--)}(e):e.classList.contains("full")&&function(e){(function(e){let t=e.getBoundingClientRect(),o=t.top,s=t.bottom;return o>=0&&s<=window.innerHeight})(e)&&(e.classList.add("v"),e.classList.remove("full"),e.classList.remove("a"),t--)}(e)}e.map((e=>o(e))),window.addEventListener("scroll",(()=>{t>0&&e.forEach((e=>{o(e)}))}))}))}),!1),document.addEventListener("DOMContentLoaded",(()=>{x=!1,document.querySelector(".settingsPopup-chess").classList.remove("hide"),Array.from(document.querySelectorAll(".difficulty-settingsPopup__level")).forEach((e=>{e.addEventListener("click",(()=>{x||(Array.from(document.querySelectorAll(".difficulty-settingsPopup__level")).forEach((e=>{e.classList.remove("select")})),k.setValue=+e.dataset.level,e.classList.add("select"))}))})),Array.from(document.querySelectorAll(".settingsPopup-side__color")).forEach((e=>{e.addEventListener("click",(()=>{x||(Array.from(document.querySelectorAll(".settingsPopup-side__color")).forEach((e=>{e.classList.remove("select")})),C.setValue=e.dataset.orientation,e.classList.add("select"))}))}));let e={orientation:C.value};H=Chessboard("board",e),A(H);let t=document.querySelector("#play"),o=document.querySelector("#playAgain");t.addEventListener("click",T,{once:!0}),o.addEventListener("click",T,{once:!0})}))})();