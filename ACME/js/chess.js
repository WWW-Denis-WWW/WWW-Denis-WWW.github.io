(()=>{"use strict";var e={529:(e,t)=>{t.qQ=t.Bg=t.yD=t.YH=t.Zf=t.E$=t.H_=t.wz=t.E5=t.Cj=void 0,t.Cj="w",t.E5="b",t.wz="p",t.H_="n",t.E$="b",t.Zf="r",t.YH="q",t.yD="k",t.Bg="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";const o=-1,s={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},n={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},r={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},i={b:[16,32,17,15],w:[-16,-32,-17,-15]},l={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},c=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],a=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],u={p:1,n:2,b:4,r:8,q:16,k:32},h=[t.H_,t.E$,t.Zf,t.YH],d={w:[{square:r.a1,flag:n.QSIDE_CASTLE},{square:r.h1,flag:n.KSIDE_CASTLE}],b:[{square:r.a8,flag:n.QSIDE_CASTLE},{square:r.h8,flag:n.KSIDE_CASTLE}]},m={b:1,w:6},f=["1-0","0-1","1/2-1/2","*"];function p(e){return e>>4}function _(e){return 15&e}function v(e){return-1!=="0123456789".indexOf(e)}function g(e){const t=_(e),o=p(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(o,o+1)}function b(e){return e===t.Cj?t.E5:t.Cj}function y(e,o,s,r,i,l,c=n.NORMAL){const a=p(r);if(i!==t.wz||7!==a&&0!==a)e.push({color:o,from:s,to:r,piece:i,captured:l,promotion:void 0,flags:c});else for(let t=0;t<h.length;t++){const a=h[t];e.push({color:o,from:s,to:r,piece:i,captured:l,promotion:a,flags:c|n.PROMOTION})}}function S(e){let o=e.charAt(0);if(o>="a"&&o<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return t.wz}return o=o.toLowerCase(),"o"===o?t.yD:o}function L(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}t.qQ=class{constructor(e=t.Bg){this._board=new Array(128),this._turn=t.Cj,this._header={},this._kings={w:o,b:o},this._epSquare=-1,this._halfMoves=0,this._moveNumber=0,this._history=[],this._comments={},this._castling={w:0,b:0},this.load(e)}clear(e=!1){this._board=new Array(128),this._kings={w:o,b:o},this._turn=t.Cj,this._castling={w:0,b:0},this._epSquare=o,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._updateSetup(this.fen())}load(e,s=!1){const i=e.split(/\s+/),l=i[0];let c=0;if(!function(e){const t=[];t[0]="No errors.",t[1]="FEN string must contain six space-delimited fields.",t[2]="6th field (move number) must be a positive integer.",t[3]="5th field (half move counter) must be a non-negative integer.",t[4]="4th field (en-passant square) is invalid.",t[5]="3rd field (castling availability) is invalid.",t[6]="2nd field (side to move) is invalid.",t[7]="1st field (piece positions) does not contain 8 '/'-delimited rows.",t[8]="1st field (piece positions) is invalid [consecutive numbers].",t[9]="1st field (piece positions) is invalid [invalid piece].",t[10]="1st field (piece positions) is invalid [row too large].",t[11]="Illegal en-passant square";const o=e.split(/\s+/);if(6!==o.length)return{valid:!1,errorNumber:1,error:t[1]};const s=parseInt(o[5],10);if(isNaN(s)||s<=0)return{valid:!1,errorNumber:2,error:t[2]};const n=parseInt(o[4],10);if(isNaN(n)||n<0)return{valid:!1,errorNumber:3,error:t[3]};if(!/^(-|[abcdefgh][36])$/.test(o[3]))return{valid:!1,errorNumber:4,error:t[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(o[2]))return{valid:!1,errorNumber:5,error:t[5]};if(!/^(w|b)$/.test(o[1]))return{valid:!1,errorNumber:6,error:t[6]};const r=o[0].split("/");if(8!==r.length)return{valid:!1,errorNumber:7,error:t[7]};for(let e=0;e<r.length;e++){let o=0,s=!1;for(let n=0;n<r[e].length;n++)if(v(r[e][n])){if(s)return{valid:!1,errorNumber:8,error:t[8]};o+=parseInt(r[e][n],10),s=!0}else{if(!/^[prnbqkPRNBQK]$/.test(r[e][n]))return{valid:!1,errorNumber:9,error:t[9]};o+=1,s=!1}if(8!==o)return{valid:!1,errorNumber:10,error:t[10]}}return"3"==o[3][1]&&"w"==o[1]||"6"==o[3][1]&&"b"==o[1]?{valid:!1,errorNumber:11,error:t[11]}:{valid:!0,errorNumber:0,error:t[0]}}(e).valid)return!1;this.clear(s);for(let e=0;e<l.length;e++){const o=l.charAt(e);if("/"===o)c+=8;else if(v(o))c+=parseInt(o,10);else{const e=o<"a"?t.Cj:t.E5;this.put({type:o.toLowerCase(),color:e},g(c)),c++}}return this._turn=i[1],i[2].indexOf("K")>-1&&(this._castling.w|=n.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(this._castling.w|=n.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(this._castling.b|=n.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(this._castling.b|=n.QSIDE_CASTLE),this._epSquare="-"===i[3]?o:r[i[3]],this._halfMoves=parseInt(i[4],10),this._moveNumber=parseInt(i[5],10),this._updateSetup(this.fen()),!0}fen(){let e=0,s="";for(let o=r.a8;o<=r.h1;o++){if(this._board[o]){e>0&&(s+=e,e=0);const{color:n,type:r}=this._board[o];s+=n===t.Cj?r.toUpperCase():r.toLowerCase()}else e++;o+1&136&&(e>0&&(s+=e),o!==r.h1&&(s+="/"),e=0,o+=8)}let i="";this._castling[t.Cj]&n.KSIDE_CASTLE&&(i+="K"),this._castling[t.Cj]&n.QSIDE_CASTLE&&(i+="Q"),this._castling[t.E5]&n.KSIDE_CASTLE&&(i+="k"),this._castling[t.E5]&n.QSIDE_CASTLE&&(i+="q"),i=i||"-";const l=this._epSquare===o?"-":g(this._epSquare);return[s,this._turn,i,l,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==t.Bg?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(t.Bg)}get(e){return this._board[r[e]]||!1}put({type:e,color:s},n){if(-1==="pnbrqkPNBRQK".indexOf(e.toLowerCase()))return!1;if(!(n in r))return!1;const i=r[n];return(e!=t.yD||this._kings[s]==o||this._kings[s]==i)&&(this._board[i]={type:e,color:s},e===t.yD&&(this._kings[s]=i),this._updateSetup(this.fen()),!0)}remove(e){const s=this.get(e);return delete this._board[r[e]],s&&s.type===t.yD&&(this._kings[s.color]=o),this._updateSetup(this.fen()),s}_attacked(e,o){for(let s=r.a8;s<=r.h1;s++){if(136&s){s+=7;continue}if(void 0===this._board[s]||this._board[s].color!==e)continue;const n=this._board[s],r=s-o,i=r+119;if(c[i]&u[n.type]){if(n.type===t.wz){if(r>0){if(n.color===t.Cj)return!0}else if(n.color===t.E5)return!0;continue}if("n"===n.type||"k"===n.type)return!0;const e=a[i];let l=s+e,c=!1;for(;l!==o;){if(null!=this._board[l]){c=!0;break}l+=e}if(!c)return!0}}return!1}_isKingAttacked(e){return this._attacked(b(e),this._kings[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&0===this._moves().length}isStalemate(){return!this.isCheck()&&0===this._moves().length}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},o=[];let s=0,n=0;for(let i=r.a8;i<=r.h1;i++){if(n=(n+1)%2,136&i){i+=7;continue}const r=this._board[i];r&&(e[r.type]=r.type in e?e[r.type]+1:1,r.type===t.E$&&o.push(n),s++)}if(2===s)return!0;if(3===s&&(1===e[t.E$]||1===e[t.H_]))return!0;if(s===e[t.E$]+2){let e=0;const t=o.length;for(let s=0;s<t;s++)e+=o[s];if(0===e||e===t)return!0}return!1}isThreefoldRepetition(){const e=[],t={};let o=!1;for(;;){const t=this._undoMove();if(!t)break;e.push(t)}for(;;){const s=this.fen().split(" ").slice(0,4).join(" ");t[s]=s in t?t[s]+1:1,t[s]>=3&&(o=!0);const n=e.pop();if(!n)break;this._makeMove(n)}return o}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:t}={}){const o=this._moves({square:t});return e?o.map((e=>this._makePretty(e))):o.map((e=>this._moveToSan(e,o)))}_moves({legal:e=!0,piece:o,square:s}={}){var c;const a=s?s.toLowerCase():void 0,u=null==o?void 0:o.toLowerCase(),h=[],d=this._turn,f=b(d);let _=r.a8,v=r.h1,g=!1;if(a){if(!(a in r))return[];_=v=r[a],g=!0}for(let e=_;e<=v;e++){if(136&e){e+=7;continue}if(!this._board[e]||this._board[e].color===f)continue;const{type:o}=this._board[e];let s;if(o===t.wz){if(u&&u!==o)continue;s=e+i[d][0],this._board[s]||(y(h,d,e,s,t.wz),s=e+i[d][1],m[d]!==p(e)||this._board[s]||y(h,d,e,s,t.wz,void 0,n.BIG_PAWN));for(let o=2;o<4;o++)s=e+i[d][o],136&s||((null===(c=this._board[s])||void 0===c?void 0:c.color)===f?y(h,d,e,s,t.wz,this._board[s].type,n.CAPTURE):s===this._epSquare&&y(h,d,e,s,t.wz,t.wz,n.EP_CAPTURE))}else{if(u&&u!==o)continue;for(let r=0,i=l[o].length;r<i;r++){const i=l[o][r];for(s=e;s+=i,!(136&s);){if(this._board[s]){if(this._board[s].color===d)break;y(h,d,e,s,o,this._board[s].type,n.CAPTURE);break}if(y(h,d,e,s,o),o===t.H_||o===t.yD)break}}}}if(!(void 0!==u&&u!==t.yD||g&&v!==this._kings[d])){if(this._castling[d]&n.KSIDE_CASTLE){const e=this._kings[d],o=e+2;this._board[e+1]||this._board[o]||this._attacked(f,this._kings[d])||this._attacked(f,e+1)||this._attacked(f,o)||y(h,d,this._kings[d],o,t.yD,void 0,n.KSIDE_CASTLE)}if(this._castling[d]&n.QSIDE_CASTLE){const e=this._kings[d],o=e-2;this._board[e-1]||this._board[e-2]||this._board[e-3]||this._attacked(f,this._kings[d])||this._attacked(f,e-1)||this._attacked(f,o)||y(h,d,this._kings[d],o,t.yD,void 0,n.QSIDE_CASTLE)}}if(!e)return h;const S=[];for(let e=0,t=h.length;e<t;e++)this._makeMove(h[e]),this._isKingAttacked(d)||S.push(h[e]),this._undoMove();return S}move(e,{sloppy:t=!1}={}){let o=null;if("string"==typeof e)o=this._moveFromSan(e,t);else if("object"==typeof e){const t=this._moves();for(let s=0,n=t.length;s<n;s++)if(e.from===g(t[s].from)&&e.to===g(t[s].to)&&(!("promotion"in t[s])||e.promotion===t[s].promotion)){o=t[s];break}}if(!o)return null;const s=this._makePretty(o);return this._makeMove(o),s}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){const s=this._turn,r=b(s);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&n.EP_CAPTURE&&(this._turn===t.E5?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:s}),this._board[e.to].type===t.yD){if(this._kings[s]=e.to,e.flags&n.KSIDE_CASTLE){const t=e.to-1,o=e.to+1;this._board[t]=this._board[o],delete this._board[o]}else if(e.flags&n.QSIDE_CASTLE){const t=e.to+1,o=e.to-2;this._board[t]=this._board[o],delete this._board[o]}this._castling[s]=0}if(this._castling[s])for(let t=0,o=d[s].length;t<o;t++)if(e.from===d[s][t].square&&this._castling[s]&d[s][t].flag){this._castling[s]^=d[s][t].flag;break}if(this._castling[r])for(let t=0,o=d[r].length;t<o;t++)if(e.to===d[r][t].square&&this._castling[r]&d[r][t].flag){this._castling[r]^=d[r][t].flag;break}e.flags&n.BIG_PAWN?s===t.E5?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=o,e.piece===t.wz||e.flags&(n.CAPTURE|n.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,s===t.E5&&this._moveNumber++,this._turn=r}undo(){const e=this._undoMove();return e?this._makePretty(e):null}_undoMove(){const e=this._history.pop();if(void 0===e)return null;const o=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;const s=this._turn,r=b(s);if(this._board[o.from]=this._board[o.to],this._board[o.from].type=o.piece,delete this._board[o.to],o.captured)if(o.flags&n.EP_CAPTURE){let e;e=s===t.E5?o.to-16:o.to+16,this._board[e]={type:t.wz,color:r}}else this._board[o.to]={type:o.captured,color:r};if(o.flags&(n.KSIDE_CASTLE|n.QSIDE_CASTLE)){let e,t;o.flags&n.KSIDE_CASTLE?(e=o.to+1,t=o.to-1):(e=o.to-2,t=o.to+1),this._board[e]=this._board[t],delete this._board[t]}return o}pgn({newline:e="\n",maxWidth:t=0}={}){const o=[];let s=!1;for(const t in this._header)o.push("["+t+' "'+this._header[t]+'"]'+e),s=!0;s&&this._history.length&&o.push(e);const n=e=>{const t=this._comments[this.fen()];return void 0!==t&&(e=`${e}${e.length>0?" ":""}{${t}}`),e},r=[];for(;this._history.length>0;)r.push(this._undoMove());const i=[];let l="";for(0===r.length&&i.push(n(""));r.length>0;){l=n(l);const e=r.pop();if(!e)break;if(this._history.length||"b"!==e.color)"w"===e.color&&(l.length&&i.push(l),l=this._moveNumber+".");else{const e=`${this._moveNumber}. ...`;l=l?`${l} ${e}`:e}l=l+" "+this._moveToSan(e,this._moves({legal:!0})),this._makeMove(e)}if(l.length&&i.push(n(l)),void 0!==this._header.Result&&i.push(this._header.Result),0===t)return o.join("")+i.join(" ");const c=function(){return o.length>0&&" "===o[o.length-1]&&(o.pop(),!0)},a=function(s,n){for(const r of n.split(" "))if(r){if(s+r.length>t){for(;c();)s--;o.push(e),s=0}o.push(r),s+=r.length,o.push(" "),s++}return c()&&s--,s};let u=0;for(let s=0;s<i.length;s++)u+i[s].length>t&&i[s].includes("{")?u=a(u,i[s]):(u+i[s].length>t&&0!==s?(" "===o[o.length-1]&&o.pop(),o.push(e),u=0):0!==s&&(o.push(" "),u++),o.push(i[s]),u+=i[s].length);return o.join("")}header(...e){for(let t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(this._header[e[t]]=e[t+1]);return this._header}loadPgn(e,{sloppy:t=!1,newlineChar:o="\r?\n"}={}){function s(e){return e.replace(/\\/g,"\\")}e=e.trim();const n=new RegExp("^(\\[((?:"+s(o)+")|.)*\\])(?:\\s*"+s(o)+"){2}").exec(e),r=n&&n.length>=2?n[1]:"";this.reset();const i=function(e){const t={},n=e.split(new RegExp(s(o)));let r="",i="";for(let e=0;e<n.length;e++){const o=/^\s*\[([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;r=n[e].replace(o,"$1"),i=n[e].replace(o,"$2"),r.trim().length>0&&(t[r]=i)}return t}(r);let l="";for(const e in i)"fen"===e.toLowerCase()&&(l=i[e]),this.header(e,i[e]);if(t){if(l&&!this.load(l,!0))return!1}else if(!("1"!==i.SetUp||"FEN"in i&&this.load(i.FEN,!0)))return!1;const c=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(s(o),"g")," ")).slice(1,e.length-1))}}`},a=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+(e.match(/.{1,2}/g)||[]).join("%"))}(e.slice(1,e.length-1))};let u=e.replace(r,"").replace(new RegExp(`({[^}]*})+?|;([^${s(o)}]*)`,"g"),(function(e,t,o){return void 0!==t?c(t):" "+c(`{${o.slice(1)}}`)})).replace(new RegExp(s(o),"g")," ");const h=/(\([^()]+\))+?/g;for(;h.test(u);)u=u.replace(h,"");u=u.replace(/\d+\.(\.\.)?/g,""),u=u.replace(/\.\.\./g,""),u=u.replace(/\$\d+/g,"");let d=u.trim().split(new RegExp(/\s+/));d=d.join(",").replace(/,,+/g,",").split(",");let m="";for(let e=0;e<d.length;e++){const o=a(d[e]);if(void 0!==o){this._comments[this.fen()]=o;continue}const s=this._moveFromSan(d[e],t);if(null==s){if(!(f.indexOf(d[e])>-1))return!1;m=d[e]}else m="",this._makeMove(s)}return m&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",m),!0}_moveToSan(e,o){let s="";if(e.flags&n.KSIDE_CASTLE)s="O-O";else if(e.flags&n.QSIDE_CASTLE)s="O-O-O";else{if(e.piece!==t.wz){const t=function(e,t){const o=e.from,s=e.to,n=e.piece;let r=0,i=0,l=0;for(let e=0,c=t.length;e<c;e++){const c=t[e].from,a=t[e].to;n===t[e].piece&&o!==c&&s===a&&(r++,p(o)===p(c)&&i++,_(o)===_(c)&&l++)}return r>0?i>0&&l>0?g(o):l>0?g(o).charAt(1):g(o).charAt(0):""}(e,o);s+=e.piece.toUpperCase()+t}e.flags&(n.CAPTURE|n.EP_CAPTURE)&&(e.piece===t.wz&&(s+=g(e.from)[0]),s+="x"),s+=g(e.to),e.promotion&&(s+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?s+="#":s+="+"),this._undoMove(),s}_moveFromSan(e,t=!1){const o=L(e);let s,n,i,l,c,a=S(o),u=this._moves({legal:!0,piece:a});for(let e=0,t=u.length;e<t;e++)if(o===L(this._moveToSan(u[e],u)))return u[e];if(!t)return null;let h=!1;n=o.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),n?(s=n[1],i=n[2],l=n[3],c=n[4],1==i.length&&(h=!0)):(n=o.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),n&&(s=n[1],i=n[2],l=n[3],c=n[4],1==i.length&&(h=!0))),a=S(o),u=this._moves({legal:!0,piece:s||a});for(let e=0,t=u.length;e<t;e++)if(i&&l){if(!(s&&s.toLowerCase()!=u[e].piece||r[i]!=u[e].from||r[l]!=u[e].to||c&&c.toLowerCase()!=u[e].promotion))return u[e];if(h){const t=g(u[e].from);if(!(s&&s.toLowerCase()!=u[e].piece||r[l]!=u[e].to||i!=t[0]&&i!=t[1]||c&&c.toLowerCase()!=u[e].promotion))return u[e]}}return null}ascii(){let e="   +------------------------+\n";for(let o=r.a8;o<=r.h1;o++){if(0===_(o)&&(e+=" "+"87654321"[p(o)]+" |"),this._board[o]){const s=this._board[o].type;e+=" "+(this._board[o].color===t.Cj?s.toUpperCase():s.toLowerCase())+" "}else e+=" . ";o+1&136&&(e+="|\n",o+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h",e}perft(e){const t=this._moves({legal:!1});let o=0;const s=this._turn;for(let n=0,r=t.length;n<r;n++)this._makeMove(t[n]),this._isKingAttacked(s)||(e-1>0?o+=this.perft(e-1):o++),this._undoMove();return o}_makePretty(e){const{color:t,piece:o,from:r,to:i,flags:l,captured:c,promotion:a}=e;let u="";for(const e in n)n[e]&l&&(u+=s[e]);const h={color:t,piece:o,from:g(r),to:g(i),san:this._moveToSan(e,this._moves({legal:!0})),flags:u};return c&&(h.captured=c),a&&(h.promotion=a),h}turn(){return this._turn}board(){const e=[];let t=[];for(let o=r.a8;o<=r.h1;o++)null==this._board[o]?t.push(null):t.push({square:g(o),type:this._board[o].type,color:this._board[o].color}),o+1&136&&(e.push(t),t=[],o+=8);return e}squareColor(e){if(e in r){const t=r[e];return(p(t)+_(t))%2==0?"light":"dark"}return null}history({verbose:e=!1}={}){const t=[],o=[];for(;this._history.length>0;)t.push(this._undoMove());for(;;){const s=t.pop();if(!s)break;e?o.push(this._makePretty(s)):o.push(this._moveToSan(s,this._moves())),this._makeMove(s)}return o}_pruneComments(){const e=[],t={},o=e=>{e in this._comments&&(t[e]=this._comments[e])};for(;this._history.length>0;)e.push(this._undoMove());for(o(this.fen());;){const t=e.pop();if(!t)break;this._makeMove(t),o(this.fen())}this._comments=t}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map((e=>({fen:e,comment:this._comments[e]})))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map((e=>{const t=this._comments[e];return delete this._comments[e],{fen:e,comment:t}}))}}}},t={};function o(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,o),r.exports}(()=>{var e=o(529);let t=document.querySelector(".popup-chess").cloneNode(!0),s=document.querySelector("#chess"),n={levelNum:0,get level(){return this.levelNum},set level(e){e>20?e=20:e<0&&(e=0),this.levelNum=e,function(e){document.querySelector("#inputLevel").value=e}(this.levelNum)}};function r(){document.querySelector(".popup-chess").remove(),document.querySelectorAll(".opponent-name").forEach((e=>e.textContent=`бот ${n.level} уровень`)),ae(re,n.level)}function i(){document.querySelector("#startPlay").addEventListener("click",r),n.levelNum=0,function(){let e=document.querySelector("#lvlUp"),t=document.querySelector("#lvlDown");e.addEventListener("click",c),t.addEventListener("click",a)}(),function(){let e=document.querySelector("#inputLevel");e.onblur=()=>{n.level=+e.value}}(),document.querySelector(".close-popup").addEventListener("click",l)}function l(){document.querySelector(".popup-chess").remove()}function c(){n.level=++n.level}function a(){n.level=--n.level}function u(e){return console.log(e),fetch(`${window.location.origin}/blabla/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(!e.ok)throw new Error(`Ошибка HTTP: ${e.status}`);return e.json()})).then((e=>(console.log("Ответ с сервера:",e),e))).catch((e=>{throw console.error("Ошибка при получении ответа с сервера:",e),e}))}function h(e,t){let o,s="Победа белых",r="Победа черных",i="Ничья, недостаток фигур",l="Ничья, патовая ситуация";t.isStalemate()?(o=l,document.title=l):t.isDraw()?(o=i,document.title=i):t.isCheckmate()?"w"===t.turn()?(o=r,document.title=r):(o=s,document.title=s):e&&("w"===e?(o=r,document.title=r):(o=s,document.title=s));let c=new Date;u({color:re,level:n.level,history:t.history({verbose:!0}),time:g,date:("0"+c.getDate()).slice(-2)+"."+("0"+(c.getMonth()+1)).slice(-2)+"."+c.getFullYear(),end:o}),function(e){let t=document.createElement("div");t.classList.add("chess__GameOver"),t.innerHTML=`\n\t\t\t<div class="gameOverBox">\n\t\t\t\t<div class="close-gameOver">\n\t\t\t\t\t<div class="close-gameOver__box">\n\t\t\t\t\t\t<div class="close-gameOver__stick"></div>\n\t\t\t\t\t\t<div class="close-gameOver__stick"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<h1>${e}</h1>\n\t\t\t</div>\n`,document.querySelector("#chess").appendChild(t),document.querySelector(".close-gameOver").addEventListener("click",d)}(o)}function d(){document.querySelector(".chess__GameOver")?.remove()}let m,f,p="my",_={1:document.querySelector("#time-my"),2:document.querySelector("#time-my2")},v={1:document.querySelector("#time-opponent"),2:document.querySelector("#time-opponent2")},g={my:600,opponent:600},b=1e3*g.my,y=1e3*g.opponent;function S(e){let t="00",o="00";return e>=60&&(t=Math.floor(e/60)),e>0&&(o=e%60),t<10&&"00"!==t&&(t="0"+t),o<10&&"00"!==o&&(o="0"+o),`${t}:${o}`}function L(){Object.values(_).map((e=>{e.innerHTML=S(g.my)})),Object.values(v).map((e=>{e.innerHTML=S(g.opponent)}))}let E,w,q=!0,k=!0;function C(e){document.title="Ваш ход!",$(),m||(m=Date.now());let t=()=>{let e=Date.now()-m;le.isGameOver()||ce?clearInterval(f):(g.my<=0&&(q=!1,Ee(!0),h(re,le)),"my"!==p?(g.my=Math.ceil((b-e)/1e3),L(),b-=e,clearInterval(f)):q?(g.my=Math.ceil((b-e)/1e3),L()):clearInterval(f))};e?t():f=setInterval(t,100)}function A(e){document.title="Ход противника!",$(),E||(E=Date.now());let t=()=>{let e=Date.now()-E;le.isGameOver()||ce?clearInterval(w):(g.opponent<=0&&(k=!1,Ee(!0),h(ie,le)),"opponent"!==p?(clearInterval(w),g.opponent=Math.ceil((y-e)/1e3),L(),y-=e):k?(g.opponent=Math.ceil((y-e)/1e3),L()):clearInterval(w))};e?t():w=setInterval(t,100)}function T({setTurn:e}){e?p=e:"my"===p?(p="opponent",E+=Date.now()-E,C(!0),A()):"opponent"===p&&(p="my",m+=Date.now()-m,A(!0),C())}function $(){"opponent"===p?(Object.values(v).map(((e,t)=>{1===t?(e.closest(".timer").classList.remove(`off${t+1}`),e.closest(".timer").classList.add(`on${t+1}`)):(e.closest(".timer").classList.remove("off"),e.closest(".timer").classList.add("on"))})),Object.values(_).map(((e,t)=>{1===t?(e.closest(".timer").classList.remove(`on${t+1}`),e.closest(".timer").classList.add(`off${t+1}`)):(e.closest(".timer").classList.remove("on"),e.closest(".timer").classList.add("off"))}))):"my"===p&&(Object.values(_).map(((e,t)=>{1===t?(e.closest(".timer").classList.remove(`off${t+1}`),e.closest(".timer").classList.add(`on${t+1}`)):(e.closest(".timer").classList.remove("off"),e.closest(".timer").classList.add("on"))})),Object.values(v).map(((e,t)=>{1===t?(e.closest(".timer").classList.remove(`on${t+1}`),e.closest(".timer").classList.add(`off${t+1}`)):(e.closest(".timer").classList.remove("on"),e.closest(".timer").classList.add("off"))})))}let M=document.querySelector(".players-chess__side.opponent"),N=document.querySelector(".players-chess__side.my");function I(e){N.classList.remove("white"),N.classList.remove("black"),M.classList.remove("white"),M.classList.remove("black"),"w"==e?(N.classList.add("white"),M.classList.add("black")):(N.classList.add("black"),M.classList.add("white"))}let P=document.querySelector(".moves-side__moves"),D=document.querySelector(".moves-headline__box");function O(){P.innerHTML="",D.innerHTML=""}let x=null,R=null,j=document.querySelector("#shapes > g");function Q(e){if(2===e.button){let e=document.querySelector(".creatingArrow"),s=document.querySelector(".creatingCircle");if(!e&&!s)return;if(t=x,o=R,document.querySelector(`#shapes line[data-squares="${t},${o}"]`))return function(e,t){document.querySelector(`#shapes line[data-squares="${e},${t}"]`).remove()}(x,R),K(),x=null,void(R=null);e&&(e.classList.remove("creatingArrow"),e.classList.add("createdArrow"),e.dataset.squares=`${x},${R}`),s&&(s.classList.remove("creatingCircle"),s.classList.add("createdCircle"))}var t,o}function K(){document.querySelector(".creatingArrow")?.remove()}function B(){j.innerHTML=""}function H(e){return e<4?String(4-e):4===e?"0":e>4?"-"+String(e-5):void 0}function U(e){return e<4?String(e-4):4===e?"-0":e>4?String(e-5):void 0}function z(e){const t=e.toUpperCase(),o="A".charCodeAt(0);return t.charCodeAt(0)-o+1}function G(e){e.preventDefault()}function F(e){j.style.transform="white"===e?"scale(-1)":"",Array.from(document.querySelectorAll(".square-55d63")).forEach((e=>{e.onmousemove=t=>{!function(e,t){if(2===e.buttons&&x===t.dataset.square&&K(),2===e.buttons&&x&&x!==t.dataset.square&&R!==t.dataset.square){document.querySelector(".creatingCircle")?.remove(),K();let e=function(e,t,o,s){return`<line class="creatingArrow" stroke="#7979C5" stroke-width="0.16" stroke-linecap="round" marker-end="url(#arrowEnd)" opacity="1" x1="${e}.5" y1="${t}.5" x2="${o}.5" y2="${s}.5"></line>`}(...function(e){let t=e.dataset.square;if(t===x)return null;let[o,s]=[z(x[0]),+x[1]],[n,r]=[z(t[0]),+t[1]];return[H(o),U(s),H(n),U(r)]}(t));j.innerHTML+=e,R=t.dataset.square}}(t,e)},e.onmousedown=t=>{!function(e,t){0===e.button&&1===e.buttons&&B(),2===e.buttons&&(x=t.dataset.square,function(e){let t=function(e,t,o){return`<circle data-square="${o}" class="creatingCircle" stroke="#7979C5" stroke-width="0.0625" fill="none" opacity="1" cx="${e}.5" cy="${t}.5" r="0.45"></circle>`}(...function(e){let t=e,[o,s]=[z(t[0]),+t[1]];return[H(o),U(s)]}(e),e);if(function(e){return document.querySelector(`#shapes circle[data-square="${e}"]`)}(e))return function(e){return document.querySelector(`#shapes circle[data-square="${e}"]`).remove()}(e);j.innerHTML+=t}(x))}(t,e)},window.addEventListener("mouseup",Q),e.oncontextmenu=G}))}function W(){Array.from(document.querySelectorAll(".square-55d63")).forEach((e=>{e.classList.remove("highlight-legal"),e.classList.remove("highlight-eat"),e.classList.remove("move")}))}function Y(e){return Array.from(e.childNodes).find((e=>e.classList.contains("piece-417db")))}let Z,J,V,X=document.querySelector("#chess");function ee(e){V.postMessage(e)}let te,oe,se,ne,re,ie,le,ce,ae,ue,he,de,me,fe="",pe=null;function _e(e,t){ge();let o=function(e){let t=Array.from(document.querySelectorAll(".moves-side__row")),o=Array.from(document.querySelectorAll(".moves-headline__move"));return[ve(t,e),ve(o,e)]}(e);o.forEach((e=>function(e,t){let o=e.querySelector(`[data-move="${t}"]`);o.classList.add("activeMoveHistory"),function(e){let t=e.closest(".moves-side__box"),o=e.closest(".moves-headline__moves");if(t){let o=e.offsetTop-t.offsetTop;t.scrollTop=o}else o&&(o.scrollLeft=e.offsetLeft-o.offsetLeft)}(o)}(e,t)))}function ve(e,t){return e.find((e=>e.dataset.rowNum==t))}function ge(){let e=Array.from(document.querySelectorAll(".activeMoveHistory"));e.length&&e.forEach((e=>e.classList.remove("activeMoveHistory")))}function be(){ue.position("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR"),qe(),W(),ge(),function(){let e=document.querySelector(".moves-side__box"),t=document.querySelector(".moves-headline__moves");e.scrollTop=0,t.scrollLeft=0}()}function ye(){ue.position(le.fen()),qe();let e=le.history({verbose:!0}),t=e[e.length-1];t&&we(e[e.length-1]),_e(Math.round(e.length/2),t.san)}function Se(){let e=de.findIndex(((e,t)=>0===e.indexOf(ue.fen())));if(0===e)return;ue.position(de[e-1]),qe();let t=le.history({verbose:!0}),o=Math.round((e-1)/2),s=t[e-2]?.san;s?_e(o,s):ge(),t[e-2]&&we(t[e-2])}function Le(){let e=de.findIndex(((e,t)=>0===e.indexOf(ue.fen())));if(e===de.length-1)return;ue.position(de[e+1]),qe();let t=le.history({verbose:!0});_e(Math.round((e+1)/2),t[e].san),we(t[e])}function Ee(e){ce=e}function we(e){he.querySelector(`.square-${e.from}`).classList.add("highlight-from"),he.querySelector(`.square-${e.to}`).classList.add("highlight-to")}function qe(){Array.from(he.querySelectorAll(".square-55d63")).map((e=>{e.classList.remove("highlight-from"),e.classList.remove("highlight-to")}))}function ke(){!function(e){let t=e.split(/\d+\./);t=t.filter((e=>""!==e.trim())).map(((e,t)=>`${t+1}. `+e.trim())),O(),t.forEach((e=>{let[t,o]=e.split(".");!function(e,t){let o=document.createElement("div"),s=t.trim().split(" ");o.classList.add("moves-side__row"),o.dataset.rowNum=e,o.innerHTML=`\n\t  <div class="moves-side__count">${e}.</div>\n\t  <div class="moves-side__move">\n\t\t  <span data-move="${s[0]}">${s[0]}</span>\n\t\t  <span data-move="${s[1]||""}">${s[1]||""}</span>\n\t  </div>\n\t  `,P.appendChild(o)}(t,o),function(e,t){let o=document.createElement("div"),s=t.trim().split(" ");o.classList.add("moves-headline__move"),o.dataset.rowNum=e,o.innerHTML=`\n\t  <span class="moves-headline__count">${e}.</span>\n      <div>\n\t\t<span data-move="${s[0]}">${s[0]}</span>\n\t\t<span data-move="${s[1]||""}">${s[1]||""}</span>\n\t  </div>\n\t  `,D.appendChild(o)}(t,o)}))}(le.pgn())}function Ce(e){le.isGameOver()||ce||(le.move(e),qe(),we(e),de.push(le.fen()),ue.position(le.fen()),ke(),Ae(),le.isGameOver()?h("opponent",le):T({game:le,gameover:ce}))}function Ae(){let e=le.history({verbose:!0});_e(Math.round(e.length/2),e[e.length-1].san)}document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".burger-header"),t=document.querySelector("body"),o=document.querySelector("header"),s=document.querySelector(".header__backdrop");function n(){e.classList.remove("active"),t.classList.remove("hide"),o.classList.remove("on")}e.addEventListener("click",(function(s){s.target.classList.contains("menu-burger__list")||s.target.classList.contains("search-header__input")||(s.target.parentNode.classList.contains("menu-burger__item")?n():(e.classList.toggle("active"),t.classList.toggle("hide"),o.classList.toggle("on")))})),s.addEventListener("click",(()=>{n()}))}),!1),document.addEventListener("DOMContentLoaded",(function(){let e=Array.from(document.querySelectorAll(".a")),t=e.length;window.addEventListener("load",(()=>{function o(e){e.classList.contains("part")?function(e){(function(e){let t=e.getBoundingClientRect(),o=t.top,s=t.bottom,n=t.height;return o+n>=0&&n+window.innerHeight>=s})(e)&&(e.classList.add("v"),e.classList.remove("part"),e.classList.remove("a"),t--)}(e):e.classList.contains("full")&&function(e){(function(e){let t=e.getBoundingClientRect(),o=t.top,s=t.bottom;return o>=0&&s<=window.innerHeight})(e)&&(e.classList.add("v"),e.classList.remove("full"),e.classList.remove("a"),t--)}(e)}e.map((e=>o(e))),window.addEventListener("scroll",(()=>{t>0&&e.forEach((e=>{o(e)}))}))}))}),!1),V=STOCKFISH("../files/stockfish.wasm"),V.onmessage=function(e){let t;t=e&&"object"==typeof e?e.data:e;let o=t.match(/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/);if(o){let e={from:o[1],to:o[2],promotion:o[3]};setTimeout((()=>{Ce(e)}),1e3)}"uciok"!==t&&"readyok"!==t&&t.substr(0,11)},V.onerror=function(e){console.error("Error in engine:",e)},ee("uci"),ee("setoption name Contempt value 0"),document.addEventListener("DOMContentLoaded",(function(){i(),function(){let e,t;[...document.querySelectorAll(".players-chess__flag"),...document.querySelectorAll(".playersMobile__flag")].map((o=>{o.addEventListener("click",(()=>{e&&t?(t===o&&clearTimeout(e),o.classList.add("show"),e=setTimeout((()=>{o.classList.remove("show")}),2e3)):(t=o,o.classList.add("show"),e=setTimeout((()=>{o.classList.remove("show")}),2e3))}))}))}(),function(){function e(e){e=window.event||e;let t=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));document.getElementById("moves").scrollLeft-=40*t,e.preventDefault()}document.getElementById("moves").addEventListener?(document.getElementById("moves").addEventListener("mousewheel",e,!1),document.getElementById("moves").addEventListener("DOMMouseScroll",e,!1)):document.getElementById("moves").attachEvent("onmousewheel",e)}(),function(){let e=document.querySelector(".right-side"),t=document.querySelector("#chat-enable");function o(){t.checked?e.classList.add("chat-off"):e.classList.remove("chat-off")}o(),t.addEventListener("click",o);let s=document.querySelector(".chat-chess"),n=document.querySelector(".chat-openbtn"),r=document.querySelector(".chat-chess__close"),i=document.querySelector(".chess__chatbackdrop");function l(){i.classList.remove("show"),s.classList.remove("show")}n.addEventListener("click",(()=>{s.classList.add("show"),i.classList.add("show")})),[r,i].map((e=>e.addEventListener("click",l)))}(),te=[document.querySelector(".controller-moves__start"),document.querySelector(".controlls-chess__start")],oe=[document.querySelector(".controller-moves__end"),document.querySelector(".controlls-chess__end")],se=[document.querySelector(".controller-moves__next"),document.querySelector(".controlls-chess__next")],ne=[document.querySelector(".controller-moves__prev"),document.querySelector(".controlls-chess__prev")],te.forEach((e=>e.onclick=be)),oe.forEach((e=>e.onclick=ye)),se.forEach((e=>e.onclick=Le)),ne.forEach((e=>e.onclick=Se)),he=document.querySelector("#board"),le=new e.qQ,de=[le.fen()];let o=[];function r(){o.length&&o.forEach((e=>{document.querySelector(`.square-${e.to}`).onclick=null}))}let l,c=!1;function a(e,t){let o=le.get(e).type,s=le.move({from:e,to:t});if(null===s){if(!function(e,t,o){if(e===t||"p"!==o)return!1;let s=le.moves({verbose:!0}).find((s=>{let n=Object.values(s),r="w"===re?8:1;return n.includes(e)&&n.includes(t)&&t.includes(r)&&"p"===o}));return!!s}(e,t,o)||e===t)return"snapback";(function(e,t,o){Z=document.createElement("div"),Z.classList.add("chess__selectPieceBackdrop"),J=document.createElement("div"),J.classList.add("chess__selectPiece","selectPiece-chess"),["q","r","b","n"].forEach((s=>{let n=document.createElement("div");n.classList.add("selectPiece-chess__piece"),n.onclick=()=>function(e){o(t,e),J.remove(),Z.remove()}(s),n.innerHTML=`\n\n\t\t<div class="img">\n                <img src="../img/chesspieces/wikipedia/${e}${s.toUpperCase()}.png" alt="${s.toUpperCase()}">\n            </div>\n            \n\t\t`,J.appendChild(n)})),X.appendChild(Z),X.appendChild(J)})(re,{from:e,to:t},p),c=!0}else we(s);return qe(),W(),"move"}function p(e,t){le.history({verbose:!0}).pop(),e.promotion=t||"q",le.move(e),c=!1,we(e),_()}function _(){c||(T({game:le,gameover:ce}),ue.position(le.fen()),de.push(le.fen()),ke(),Ae(),le.isGameOver()?h("my",le):(me(),r()))}function v(){let e="",t=le.history({verbose:!0});for(let o=0;o<t.length;++o){let s=t[o];e+=" "+s.from+s.to+(s.promotion?s.promotion:"")}!function(e){ee("position startpos moves "+e)}(e),function(e){if(e!==pe){pe=e,e<0&&(e=0),e>20&&(e=20),e>0&&e<3?fe="1":e>=3&&e<5?fe="2":e>=5&&e<7?fe="3":e>=7&&e<10?fe="4":e>=10&&e<15?fe="5":e>=15&&e<18?fe="10":e>=18&&(fe="15"),V.level=e,V.depth=fe;let t=Math.round(6.35*e+1),o=Math.round(-.5*e+10);ee(`setoption name Skill Level value ${e}`),ee("setoption name Skill Level Maximum Error value "+o),ee("setoption name Skill Level Probability value "+t)}ee(`go depth ${fe}`)}(n.level)}function S(){let e=le.moves({verbose:!0});if(0===e.length)return;let t=e[Math.floor(Math.random()*e.length)];l=setTimeout((()=>{Ce(t)}),1e3)}let M,N="b";re="w"===N?"w":"b",ie="w"===N?"b":"w",I(N),ce=!1,ae=(e,t)=>{me=0===t?S:v,"w"===e?(M=/^b/,T({setTurn:"my"}),C()):"b"===e&&(M=/^w/,T({setTurn:"opponent"}),A(),me()),$(),u({color:re,level:n.level})};let P={draggable:!0,orientation:"w"==re?"white":"black",position:"start",onDragStart:function(e,t,s,n){if(le.isGameOver()||ce||!le.fen().includes(ue.fen()))return!1;if(-1!==t.search(M))return!1;let i=le.moves({verbose:!0,square:e});var l;l=i,W(),l[0]&&(document.querySelector(`.square-${l[0].from}`).classList.add("highlight-legal"),l.forEach((e=>{let t=document.querySelector(`.square-${e.to}`);Y(t)&&t.classList.contains("highlight-to")&&t.classList.add("highlight-eat"),t.classList.contains("highlight-to")||(Y(t)?t.classList.add("highlight-eat"):t.classList.add("move"))}))),function(e){r(),o=e,e.forEach((e=>{document.querySelector(`.square-${e.to}`).onclick=()=>{let t=a(e.from,e.to);"snapback"!==t&&"move"!==t||_()}}))}(i)},onDrop:a,onSnapEnd:_};ue=Chessboard("board",P),function(e){let t=document.querySelector(".board-chess__wrapper"),o=document.querySelector(".board-b72b1"),s=document.querySelector(".board-chess__board"),n=document.querySelector("#shapes");function r(){let r=document.querySelector(".playersMobile"),i=t.offsetWidth,l=t.offsetHeight,c=30;window.innerWidth<=479.98&&(c=20),i>l?(s.style.width=l-c+"px",e.resize(l-c,l-c),r.style.width=`${l}px`,r.style.height=`${l}px`):(s.style.width=i-c+"px",e.resize(i-c,i-c),r.style.width=`${i}px`,r.style.height=`${i}px`),n.style.width=o.style.width,n.style.height=o.style.width,F()}r(),window.addEventListener("resize",r)}(ue),F();let D=document.querySelector("#play-white"),x=document.querySelector("#play-black");function R(o){l&&clearTimeout(l),N=o,M="w"==N?/^w/:/^b/,le=new e.qQ,ce=!1,re="w"===N?"w":"b",de=[le.fen()],clearInterval(f),clearInterval(w),m=null,E=null,q=!0,k=!0,g={my:600,opponent:600},b=1e3*g.my,y=1e3*g.opponent,L(),d(),I(N),ue.start(!1),ue.orientation("w"==N?"white":"black"),O(),F("w"==N?"white":"black"),B(),s.appendChild(t),i()}D.addEventListener("click",(()=>R("w"))),x.addEventListener("click",(()=>R("b")))}))})()})();